{"mappings":"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","sources":["<anon>","src/profile.ts","src/scripts/modules/logout.ts","src/scripts/modules/profile.ts","src/scripts/UserAPI.ts","src/scripts/modules/tasks.ts","src/scripts/addTask.ts","src/scripts/deleteTask.ts","src/scripts/isHaveTask.ts","src/scripts/loadTasks.ts","src/scripts/saveTasks.ts","src/scripts/sortTodo.ts","src/scripts/toggleComplete.ts"],"sourcesContent":["var $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire772a\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire772a\"] = parcelRequire;\n}\n\nvar $j7Wwz = parcelRequire(\"j7Wwz\");\n\nvar $h1zpV = parcelRequire(\"h1zpV\");\n\nvar $4IDor = parcelRequire(\"4IDor\");\nconst $7c908249765fbe3c$var$refs = (0, $h1zpV.default)();\n$7c908249765fbe3c$var$refs.logOutBtn.addEventListener(\"click\", $7c908249765fbe3c$var$onClickLogOut);\nfunction $7c908249765fbe3c$var$onClickLogOut() {\n    (0, $4IDor.default).show();\n    (0, $j7Wwz.default).logOut().then(()=>{\n        setTimeout(()=>{\n            (0, $4IDor.default).hide();\n            location.replace(\"/\");\n        }, 200);\n    });\n}\n\n\n\nvar $6AR8M = parcelRequire(\"6AR8M\");\n\nvar $j7Wwz = parcelRequire(\"j7Wwz\");\nclass $fd7d6bee44cfe707$export$876a370b744f2197 {\n    static createUser(key, userData) {\n        const { uid: uid, name: name, email: email, avatar: avatar } = userData;\n        const userJSON = localStorage.getItem(key);\n        const user = userJSON !== null ? JSON.parse(userJSON) : undefined;\n        if (user && user.uid === uid) return;\n        const newUser = {\n            uid: uid,\n            email: email,\n            name: name ?? \"User\",\n            avatar: avatar ?? \"https://picsum.photos/200\"\n        };\n        localStorage.setItem(key, JSON.stringify(newUser));\n    }\n    static getUser(key) {\n        const userJSON = localStorage.getItem(key);\n        return userJSON !== null ? JSON.parse(userJSON) : undefined;\n    }\n    static saveUserAvatar(key, picURL) {\n        const userJSON = localStorage.getItem(key);\n        const user = userJSON !== null ? JSON.parse(userJSON) : undefined;\n        user.avatar = picURL;\n        localStorage.setItem(key, JSON.stringify(user));\n    }\n}\n\n\n\nvar $h1zpV = parcelRequire(\"h1zpV\");\nlet $84c7b053efce09e3$var$USER_STORAGE_KEY = \"\";\nconst $84c7b053efce09e3$var$refs = (0, $h1zpV.default)();\n$84c7b053efce09e3$var$refs.inputFile.addEventListener(\"change\", $84c7b053efce09e3$var$onChangeInputFile);\nfunction $84c7b053efce09e3$var$onChangeInputFile() {\n    const reader = new FileReader();\n    reader.addEventListener(\"load\", ()=>{\n        const readerResult = reader.result;\n        if (typeof readerResult === \"string\") {\n            (0, $fd7d6bee44cfe707$export$876a370b744f2197).saveUserAvatar($84c7b053efce09e3$var$USER_STORAGE_KEY, readerResult);\n            $84c7b053efce09e3$var$setProfilePic($84c7b053efce09e3$var$refs.profileImg, readerResult);\n        }\n    });\n    // @ts-ignore\n    reader.readAsDataURL(this.files[0]);\n}\n(0, $6AR8M.onAuthStateChanged)((0, $j7Wwz.auth), (user)=>{\n    if (user) {\n        let { uid: uid, displayName: name, email: email, photoURL: avatar } = user;\n        const savedUser = (0, $fd7d6bee44cfe707$export$876a370b744f2197).getUser(uid);\n        $84c7b053efce09e3$var$USER_STORAGE_KEY = uid;\n        if (!savedUser || savedUser.uid !== uid) {\n            (0, $fd7d6bee44cfe707$export$876a370b744f2197).createUser(user.uid, {\n                uid: uid,\n                name: name,\n                email: email,\n                avatar: avatar\n            });\n            const storedUser = (0, $fd7d6bee44cfe707$export$876a370b744f2197).getUser(uid);\n            $84c7b053efce09e3$var$setUserProfileInfo(storedUser);\n        } else $84c7b053efce09e3$var$setUserProfileInfo(savedUser);\n    }\n});\nfunction $84c7b053efce09e3$var$setUserProfileInfo(user) {\n    $84c7b053efce09e3$var$refs.profileName.textContent = user.name;\n    $84c7b053efce09e3$var$refs.profileNick.textContent = user.email;\n    user.avatar && $84c7b053efce09e3$var$setProfilePic($84c7b053efce09e3$var$refs.profileImg, user.avatar);\n}\nfunction $84c7b053efce09e3$var$setProfilePic(el, link) {\n    el.style.backgroundImage = `url(${link})`;\n}\n\n\n\nvar $6AR8M = parcelRequire(\"6AR8M\");\n\nvar $j7Wwz = parcelRequire(\"j7Wwz\");\nfunction $ee110fa789a87418$export$2e2bcd8739ae039(tasks, rootEl) {\n    if (!tasks) return;\n    const markup = tasks.map(({ id: id, value: value, isCompleted: isCompleted })=>{\n        return `\n        <li id=${id} class=\"task\" >\n          <label class=\"task__label\">\n            <input type=\"checkbox\" ${isCompleted && \"checked\"} />\n            <span class=\"task__custom-check\"></span>\n            <span class=\"task__name\">${value}</span>\n            </label>\n            <button class=\"delete-task-btn\">&#x2715;</button>\n        </li>\n    `;\n    });\n    rootEl.innerHTML = markup.join(\"\");\n}\n\n\nfunction $295db5f2d40f5f52$export$2e2bcd8739ae039(el, tasks, id) {\n    el.remove();\n    tasks.forEach((task, idx)=>{\n        if (task.id === id) tasks.splice(idx, 1);\n    });\n}\n\n\n\nvar $h1zpV = parcelRequire(\"h1zpV\");\nfunction $a96658ea250a852d$export$2e2bcd8739ae039(tasks, value) {\n    if (!tasks) return;\n    const task = tasks.find((task)=>task.value === value);\n    return !!task;\n}\n\n\nfunction $e1b0dbe339fa401a$export$2e2bcd8739ae039(key) {\n    const userJSON = localStorage.getItem(key);\n    const user = userJSON !== null ? JSON.parse(userJSON) : undefined;\n    return !user.tasks ? [] : user.tasks;\n}\n\n\nfunction $873c635bd5a168ee$export$2e2bcd8739ae039(tasks, key) {\n    try {\n        const userJSON = localStorage.getItem(key);\n        const user = userJSON !== null ? JSON.parse(userJSON) : {};\n        const userData = {\n            ...user,\n            tasks: [\n                ...tasks\n            ]\n        };\n        const serializedState = JSON.stringify(userData);\n        if (serializedState == \"null\" || serializedState === undefined) throw new Error();\n        localStorage.setItem(key, serializedState);\n    } catch (err) {\n        alert(`LocalStorage set error! Value cannot be null | undefined`);\n    }\n}\n\n\nfunction $9fb81eb39a32d161$export$2e2bcd8739ae039(tasks, order) {\n    if (order === 1) tasks.sort((a, b)=>{\n        const first = a.isCompleted ? 1 : -1;\n        const sec = b.isCompleted ? 1 : -1;\n        return sec - first;\n    });\n    else if (order === -1) tasks.sort((a, b)=>{\n        const first = a.isCompleted ? 1 : -1;\n        const sec = b.isCompleted ? 1 : -1;\n        return first - sec;\n    });\n}\n\n\nfunction $74770ea82ca408ba$export$2e2bcd8739ae039(tasks, id) {\n    tasks.forEach((task)=>{\n        if (task.id === id) task.isCompleted = !task.isCompleted;\n    });\n}\n\n\nconst $b1c8543fdc962748$var$refs = (0, $h1zpV.default)();\nlet $b1c8543fdc962748$var$USER_STORAGE_KEY = \"\";\nlet $b1c8543fdc962748$var$allTasks = [];\n(0, $6AR8M.onAuthStateChanged)((0, $j7Wwz.auth), (user)=>{\n    $b1c8543fdc962748$var$USER_STORAGE_KEY = user?.uid ?? \"\";\n    $b1c8543fdc962748$var$allTasks = (0, $e1b0dbe339fa401a$export$2e2bcd8739ae039)($b1c8543fdc962748$var$USER_STORAGE_KEY);\n    (0, $ee110fa789a87418$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$refs.tasksList);\n});\n$b1c8543fdc962748$var$refs.addTaskForm.addEventListener(\"submit\", $b1c8543fdc962748$var$onSubmitCreateTask);\n$b1c8543fdc962748$var$refs.tasksList.addEventListener(\"click\", $b1c8543fdc962748$var$onClickTasksList);\nfunction $b1c8543fdc962748$var$onSubmitCreateTask(e) {\n    e.preventDefault();\n    const taskVal = $b1c8543fdc962748$var$refs.taskInput.value.trim();\n    if (!taskVal || (0, $a96658ea250a852d$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks?.allTasks, taskVal)) return;\n    const newTask = {\n        id: Date.now(),\n        value: taskVal,\n        isCompleted: false\n    };\n    $b1c8543fdc962748$var$allTasks.unshift(newTask);\n    (0, $ee110fa789a87418$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$refs.tasksList);\n    (0, $873c635bd5a168ee$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$USER_STORAGE_KEY);\n    $b1c8543fdc962748$var$refs.taskInput.value = \"\";\n}\nfunction $b1c8543fdc962748$var$onClickTasksList(e) {\n    const target = e.target;\n    const customCheck = target.classList.contains(\"task__custom-check\");\n    const taskName = target.classList.contains(\"task__name\");\n    if (customCheck || taskName) {\n        const id = +target.closest(\"li\").id;\n        (0, $74770ea82ca408ba$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, id);\n        $b1c8543fdc962748$var$sortCompleted();\n        (0, $873c635bd5a168ee$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$USER_STORAGE_KEY);\n    } else if (target.classList.contains(\"delete-task-btn\")) {\n        const task = target.closest(\"li\");\n        (0, $295db5f2d40f5f52$export$2e2bcd8739ae039)(task, $b1c8543fdc962748$var$allTasks, +task.id);\n        (0, $873c635bd5a168ee$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$USER_STORAGE_KEY);\n    }\n}\nfunction $b1c8543fdc962748$var$sortCompleted() {\n    (0, $9fb81eb39a32d161$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, -1);\n    document.querySelectorAll(\".task\").forEach((task)=>{\n        task.addEventListener(\"transitionend\", ()=>{\n            const id = setTimeout(()=>{\n                (0, $ee110fa789a87418$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$refs.tasksList);\n                (0, $873c635bd5a168ee$export$2e2bcd8739ae039)($b1c8543fdc962748$var$allTasks, $b1c8543fdc962748$var$USER_STORAGE_KEY);\n                clearTimeout(id);\n            }, 100);\n        });\n    });\n}\n\n\n\n\n//# sourceMappingURL=profile.e68e95e6.js.map\n","import './scripts/modules/logout';\nimport './scripts/modules/profile';\nimport './scripts/modules/tasks';\n","import AuthAPI from 'src/API/AuthAPI';\nimport getRefs from '../getRefs';\nimport loader from '../loader';\n\nconst refs = getRefs();\n\nrefs.logOutBtn.addEventListener('click', onClickLogOut);\n\nfunction onClickLogOut() {\n  loader.show();\n  AuthAPI.logOut().then(() => {\n    setTimeout(() => {\n      loader.hide();\n      location.replace('/');\n    }, 200);\n  });\n}\n","import { onAuthStateChanged } from 'firebase/auth';\n\nimport { auth } from 'src/API/AuthAPI';\nimport { User } from 'src/types/types';\nimport { UserAPI } from '../UserAPI';\nimport getRefs from '../getRefs';\n\nlet USER_STORAGE_KEY = '';\nconst refs = getRefs();\n\nrefs.inputFile.addEventListener('change', onChangeInputFile);\n\nfunction onChangeInputFile() {\n  const reader = new FileReader();\n  reader.addEventListener('load', () => {\n    const readerResult = reader.result;\n\n    if (typeof readerResult === 'string') {\n      UserAPI.saveUserAvatar(USER_STORAGE_KEY, readerResult);\n      setProfilePic(refs.profileImg, readerResult);\n    }\n  });\n  // @ts-ignore\n  reader.readAsDataURL(this.files[0]);\n}\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    let { uid, displayName: name, email, photoURL: avatar } = user;\n    const savedUser = UserAPI.getUser(uid);\n\n    USER_STORAGE_KEY = uid;\n\n    if (!savedUser || savedUser.uid !== uid) {\n      UserAPI.createUser(user.uid, {\n        uid,\n        name,\n        email,\n        avatar,\n      });\n\n      const storedUser = UserAPI.getUser(uid);\n      setUserProfileInfo(storedUser);\n    } else {\n      setUserProfileInfo(savedUser);\n    }\n  } else {\n  }\n});\n\nfunction setUserProfileInfo(user: User) {\n  refs.profileName.textContent = user.name;\n  refs.profileNick.textContent = user.email;\n\n  user.avatar && setProfilePic(refs.profileImg, user.avatar);\n}\n\nfunction setProfilePic(el: HTMLElement, link: string) {\n  el.style.backgroundImage = `url(${link})`;\n}\n","import { User } from 'src/types/types';\n\nexport class UserAPI {\n  static createUser(key: string, userData: User) {\n    const { uid, name, email, avatar } = userData;\n    const userJSON = localStorage.getItem(key);\n    const user = userJSON !== null ? JSON.parse(userJSON) : undefined;\n\n    if (user && user.uid === uid) return;\n\n    const newUser = {\n      uid,\n      email,\n      name: name ?? 'User',\n      avatar: avatar ?? 'https://picsum.photos/200',\n    };\n\n    localStorage.setItem(key, JSON.stringify(newUser));\n  }\n\n  static getUser(key: string) {\n    const userJSON = localStorage.getItem(key);\n    return userJSON !== null ? JSON.parse(userJSON) : undefined;\n  }\n\n  static saveUserAvatar(key: string, picURL: string) {\n    const userJSON = localStorage.getItem(key);\n    const user: User = userJSON !== null ? JSON.parse(userJSON) : undefined;\n\n    user.avatar = picURL;\n    localStorage.setItem(key, JSON.stringify(user));\n  }\n}\n","import { onAuthStateChanged } from 'firebase/auth';\n\nimport AuthAPI, { auth } from 'src/API/AuthAPI';\nimport { Task } from 'src/types/types';\nimport addTask from '../addTask';\nimport deleteTask from '../deleteTask';\nimport getRefs from '../getRefs';\nimport isHaveTask from '../isHaveTask';\nimport loadTasks from '../loadTasks';\nimport saveTasks from '../saveTasks';\nimport sortTodo from '../sortTodo';\nimport toggleComplete from '../toggleComplete';\n\nconst refs = getRefs();\nlet USER_STORAGE_KEY = '';\nlet allTasks: any = [];\n\nonAuthStateChanged(auth, user => {\n  USER_STORAGE_KEY = user?.uid ?? '';\n  allTasks = loadTasks(USER_STORAGE_KEY);\n\n  addTask(allTasks, refs.tasksList);\n});\n\nrefs.addTaskForm.addEventListener('submit', onSubmitCreateTask);\nrefs.tasksList.addEventListener('click', onClickTasksList);\n\nfunction onSubmitCreateTask(e: SubmitEvent) {\n  e.preventDefault();\n  const taskVal = refs.taskInput.value.trim();\n\n  if (!taskVal || isHaveTask(allTasks?.allTasks, taskVal)) return;\n\n  const newTask: Task = {\n    id: Date.now(),\n    value: taskVal,\n    isCompleted: false,\n  };\n  allTasks.unshift(newTask);\n\n  addTask(allTasks, refs.tasksList);\n  saveTasks(allTasks, USER_STORAGE_KEY);\n\n  refs.taskInput.value = '';\n}\n\nfunction onClickTasksList(e: any) {\n  const target = e.target;\n  const customCheck = target.classList.contains('task__custom-check');\n  const taskName = target.classList.contains('task__name');\n\n  if (customCheck || taskName) {\n    const id = +target.closest('li').id;\n\n    toggleComplete(allTasks, id);\n    sortCompleted();\n    saveTasks(allTasks, USER_STORAGE_KEY);\n  } else if (target.classList.contains('delete-task-btn')) {\n    const task = target.closest('li');\n\n    deleteTask(task, allTasks, +task.id);\n    saveTasks(allTasks, USER_STORAGE_KEY);\n  }\n}\n\nfunction sortCompleted() {\n  sortTodo(allTasks, -1);\n\n  document.querySelectorAll('.task').forEach(task => {\n    task.addEventListener('transitionend', () => {\n      const id = setTimeout(() => {\n        addTask(allTasks, refs.tasksList);\n        saveTasks(allTasks, USER_STORAGE_KEY);\n        clearTimeout(id);\n      }, 100);\n    });\n  });\n}\n","import { Task } from '../types/types';\n\nexport default function addTask(tasks: Task[], rootEl: HTMLElement) {\n  if (!tasks) return;\n\n  const markup = tasks.map(({ id, value, isCompleted }) => {\n    return `\n        <li id=${id} class=\"task\" >\n          <label class=\"task__label\">\n            <input type=\"checkbox\" ${isCompleted && 'checked'} />\n            <span class=\"task__custom-check\"></span>\n            <span class=\"task__name\">${value}</span>\n            </label>\n            <button class=\"delete-task-btn\">&#x2715;</button>\n        </li>\n    `;\n  });\n\n  rootEl.innerHTML = markup.join('');\n}\n","import { Task } from '../types/types';\n\nexport default function deleteTask(\n  el: HTMLLIElement,\n  tasks: Task[],\n  id: number\n) {\n  el.remove();\n  tasks.forEach((task, idx) => {\n    if (task.id === id) {\n      tasks.splice(idx, 1);\n    }\n  });\n}\n","import { Task } from '../types/types';\n\nexport default function isHaveTask(tasks: Task[], value: string) {\n  if (!tasks) return;\n\n  const task = tasks.find(task => task.value === value);\n  return !!task;\n}\n","import { User } from 'src/types/types';\n\nexport default function loadTasks(key: string) {\n  const userJSON = localStorage.getItem(key);\n  const user: User = userJSON !== null ? JSON.parse(userJSON) : undefined;\n\n  return !user.tasks ? [] : user.tasks;\n}\n","import { Task } from '../types/types';\n\nexport default function saveTasks(tasks: Task[], key: string) {\n  try {\n    const userJSON = localStorage.getItem(key);\n    const user = userJSON !== null ? JSON.parse(userJSON) : {};\n    const userData = {\n      ...user,\n      tasks: [...tasks],\n    };\n    const serializedState = JSON.stringify(userData);\n\n    if (serializedState == 'null' || serializedState === undefined)\n      throw new Error();\n\n    localStorage.setItem(key, serializedState);\n  } catch (err) {\n    alert(`LocalStorage set error! Value cannot be null | undefined`);\n  }\n}\n","import { Task } from 'src/types/types';\n\nexport default function sortTodo(tasks: Task[], order: number) {\n  if (order === 1) {\n    tasks.sort((a, b) => {\n      const first = a.isCompleted ? 1 : -1;\n      const sec = b.isCompleted ? 1 : -1;\n\n      return sec - first;\n    });\n  } else if (order === -1) {\n    tasks.sort((a, b) => {\n      const first = a.isCompleted ? 1 : -1;\n      const sec = b.isCompleted ? 1 : -1;\n\n      return first - sec;\n    });\n  }\n}\n","import { Task } from '../types/types';\n\nexport default function toggleComplete(tasks: Task[], id: number) {\n  tasks.forEach(task => {\n    if (task.id === id) {\n      task.isCompleted = !task.isCompleted;\n    }\n  });\n}\n"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$j7Wwz","$h1zpV","$4IDor","$7c908249765fbe3c$var$refs","default","logOutBtn","addEventListener","show","logOut","then","setTimeout","hide","location","replace","$6AR8M","$fd7d6bee44cfe707$export$876a370b744f2197","createUser","key","userData","uid","name","email","avatar","userJSON","localStorage","getItem","user","JSON","parse","undefined","setItem","stringify","getUser","saveUserAvatar","picURL","$84c7b053efce09e3$var$USER_STORAGE_KEY","$84c7b053efce09e3$var$refs","$84c7b053efce09e3$var$setUserProfileInfo","profileName","textContent","profileNick","$84c7b053efce09e3$var$setProfilePic","profileImg","el","link","style","backgroundImage","inputFile","reader","FileReader","readerResult","result","readAsDataURL","files","onAuthStateChanged","auth","displayName","photoURL","savedUser","storedUser","$ee110fa789a87418$export$2e2bcd8739ae039","tasks","rootEl","markup","map","value","isCompleted","innerHTML","join","$873c635bd5a168ee$export$2e2bcd8739ae039","serializedState","alert","$b1c8543fdc962748$var$refs","$b1c8543fdc962748$var$USER_STORAGE_KEY","$b1c8543fdc962748$var$allTasks","tasksList","addTaskForm","e","preventDefault","taskVal","taskInput","trim","task","find","allTasks","newTask","Date","now","unshift","target","customCheck","classList","contains","taskName","closest","forEach","sort","a","b","first","sec","document","querySelectorAll","clearTimeout","remove","idx","splice"],"version":3,"file":"profile.e68e95e6.js.map"}